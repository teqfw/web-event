## Frontend sessions

Фронт - это профиль в браузере. Доступ к IDB и кэшу разделяется на уровне фронтов. Один фронт не может иметь доступ к
IDB другого фронта. Сессия - это отдельная вкладка в браузере. Если в браузере открыто несколько вкладок одного
приложения, то имеем один фронт и несколько сессий.

Фронт идентифицируется своим UUID и ассиметричным ключом. Каждая вкладка должна иметь свой собственный поток сообщений
от бэка к фронту (чтобы сообщения не путались). Т.о., каждая вкладка должна иметь свой собственный UUID (sessionUuid).

Этому sessionUuid'у ставится в соответствие streamUuid - идентификатор SSE-канала, по которому бэк доставляет сообщения
на фронт. Все сообщения, которые уходят с фронта по прямому каналу, содержат в мета-данных идентификатор SSE-канала. По
идентификатору SSE-канала бэк отправляет ответ обратно (если таковой ответ предусматривается).

Если фронт находится offline, то все сообщения фронта пишутся в очередь (IDB). При восстановлении соединения с бэком
сообщения из очереди отправляются на бэк. Проблема в том, что все сессии фронта пишут свои сообщения в IDB, а UUID
сессии после восстановления обратного соединения отличается от UUID'а сессии до его обрыва.

Такая же проблема есть и на бэке - бэк сохраняет сообщения с номером сессии/потока в очередь (RDB), а после
восстановления соединения UUID сессии изменяется.

Значит нужно как-то персистить UUID сессии на фронте.

Что такое сессия на фронте? Фронт-сессия - это идентификатор определённой вкладки браузера по отношению к
фронт-приложению, загруженному с определённого origin. У каждой вкладки для каждого origin имеется свой собственный
Session Storage. Пока вкладка не закрыта, все запросы на открытие обратного канала для получения сообщений о событиях
должны сопровождаться этим sessionUuid'ом:

```text
https://origin/web-event-stream-open/frontUuid/sessUuid
```

Этот `sessionUuid` сохраняется в реестре открытых потоков (`TeqFw_Web_Event_Back_Mod_Registry_Stream`) и используется,
если на бэке возникает необходимость отправить сообщение для конкретной вкладки.

## Open the Reverse Channel

`sessionUuid` инициируется в `TeqFw_Web_Event_Front_Mod_Identity_Session`:

* извлекается из sessionStorage браузера (если он там есть);
* генерируется новый и сохраняется в sessionStorage браузера;

Таким образом, пока открыта вкладка браузера, все запросы к бэку для открытия SSE-канала будут идти с одним и тем
же `sessionUuid`.