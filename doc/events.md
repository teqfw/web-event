# Events

Событие - это "существенное изменение состояния" (web-приложения). Существенное - значит, что событие связанно с
некоторыми данными (количественными или качественными). У каждого события есть свой источник (agent) и один или более
потребителей (sinks). События от источника к потребителям двигаются по каналам.

An event-driven system typically consists of event emitters (or agents), event consumers (or sinks), and event channels.

## Event message

Сообщение о событии - это дата-объект (без поведения), состоящий из двух групп атрибутов:

* `data`: информационные атрибуты события (например: "запрос на аутентификацию пользователя с именем 'alex' и паролем '
  SomePassword').
* `meta`: служебные атрибуты события (имя события, генератор события, время генерации, время жизни, получатели и т.п.).

Первая группа атрибутов изменяется в зависимости от типа событий (аутентификация, перевод средств, оформление
заказа, ...), вторая группа зависит от среды, в которой циркулируют события (канала).

## Channels

### Simple channel

Простейший случай - когда источник события напрямую информирует о событии его потребителя. В таком случае `meta`
-атрибуты вырождаются в ничего. Если источник может генерировать события нескольких типов, то в `meta`-атрибутах должен
присутствовать тип события.

### Network

Если есть множество источников и/или множество потребителей, то `meta`-атрибуты могут содержать идентификаторы источника
и/или получателя сообщения. В подобной инфраструктуре должны присутствовать Маршрутизаторы сообщений, которые на
основании `meta`-атрибутов сообщения доставляют их соответствующим потребителям.

### Throttled channel

Если события от источника к потребителю передаются по нестабильному каналу (который может спорадически закрываться для
передачи), то `meta`-атрибуты могут дополнительно содержать TTL-данные для конкретного сообщения.

## Event message factory

Структура сообщения о событии одинакова для всех событий:

* `data`
* `meta`

Но структура атрибута `data` отличается от события к событию, а структура атрибута `meta` - от канала к каналу.

В приложении можно выделить следующие каналы:

* `локальный`: сообщения о событии не выходят за рамки текущей области исполнения кода (фронт или бэк).
* `трансграничный`: сообщение о событии передаётся с фронта на бэк или наоборот.

Трансграничные сообщения можно разделить (или не делить?) на:

* `front`: получателем сообщения является любой фронт, способный расшифровать сообщение;
* `session`: получателем является конкретная вкладка в браузере (сессия); 